Automated Invoice Processing Solution Outline
Current Process and Requirements
The Accounts Payable (AP) process is currently manual: invoices in PDF format are stored in SharePoint Online (SPO), and staff manually extract data and enter it into the system. No OCR (Optical Character Recognition) or AI is used yet, and there is no Human-In-The-Loop (HITL) review aside from the manual process itself. The goal is to automate data extraction from invoices and present the results in a user interface for verification. The solution will be built using technologies the team is strong in (Python with FastAPI for backend and React for frontend). Initially, it will handle English invoices only (with future extensibility to both official languages, English and French). The final output of the process will integrate with Microsoft Dynamics GP (Great Plains), meaning the extracted and approved invoice data must be staged in a way that can be imported or pushed into Dynamics GP for payment processing. Additionally, because this is a Canadian federal government context, the process must comply with the Financial Administration Act – in particular Section 34, which requires verification that goods or services have been received as contracted before payment[1]. This compliance need informs the design of the workflow, especially around purchase order matching and approvals. The project will be implemented in phases, as described below, to incrementally deliver functionality:
1.	Phase 1 – Data Extraction and Staging: Automate invoice data capture and display it in a UI for human review, correction, and approval (submission).
2.	Phase 2 – PO and Invoice Matching (Section 34 verification): Implement matching of invoices to Purchase Orders and other checks to fulfill Section 34 requirements before payment approval.
3.	Phase 3 – “Red Box” Approval and Workflow: Implement an approval workflow (often referred to internally as the "red box" process) for final sign-offs (e.g. Section 34 manager approval and Section 33 finance authorization) and integrate with the payment system.
Each phase is detailed below, including the approach, tools/technologies, and how it satisfies the requirements.
Phase 1: Data Extraction & Human-in-the-Loop Verification
Objective: Eliminate manual data entry by using OCR/AI to extract key invoice data automatically, then present the invoice and extracted data in a user interface for a human to verify and correct as needed before submitting. This phase establishes the core data capture capability and introduces a Human-in-the-Loop (HITL) step to ensure accuracy.
1.1 Invoice OCR and Data Extraction
To extract data from the PDF invoices, the solution will leverage an AI-based OCR service. A strong candidate is Azure Form Recognizer (now part of Azure AI Document Intelligence), specifically its pre-built invoice model. This service is well-suited since the data is already in Azure and it’s designed to pull structured information from invoices with minimal configuration. Key points about the Azure Form Recognizer invoice model:
•	It uses advanced OCR to extract key fields and line items from invoices, including invoice number, dates, totals, vendor and customer names, addresses, taxes, and line item details[2][3]. In other words, it parses the invoice into a structured JSON output containing all relevant AP fields. This covers the Invoice and Data Table mentioned – the model will return both header information and the line-item table.
•	It is pre-trained on millions of invoices and achieves high accuracy (around 95%+ out-of-the-box for typical invoices)[4]. This means the majority of invoices will be correctly read by the AI without custom training, significantly reducing manual errors and effort.
•	It supports multiple languages. Initially we focus on English invoices, but the model can handle French and many other languages when needed – Microsoft reports the invoice model supports invoices in 27 languages including English and French[5]. This ensures future bilingual requirements can be met with minimal changes (likely just configuring language settings or letting the model auto-detect).
•	It returns results with confidence scores, which can be used to flag low-confidence fields for closer human review. All extracted data comes in a structured JSON format, “ready to integrate with other systems”[6] – for example, it can be directly mapped into a database or sent to Dynamics GP after validation.
Approach: We will create a Python-based microservice (using FastAPI) that handles the OCR step: it will receive a PDF (or a reference to it in SharePoint/Azure storage), call the Azure Form Recognizer API, and get back the extracted data. The steps might be:
1.	Trigger: When a new invoice PDF is added to the SPO library (or when a user initiates processing), our service is triggered. This trigger could be done via Power Automate (listening to the SharePoint library) or via a custom integration. For example, a Power Automate flow could detect a new file and send it to an Azure Function or our FastAPI endpoint. Using Power Automate here is optional; it provides a no-code way to connect SharePoint with our processing service. Given the team’s Python expertise, an alternative is to use the SharePoint API or Microsoft Graph to fetch the file directly from our application when needed. We will choose the mechanism that best balances ease and control – Power Automate is an option to quickly enable the integration with SPO, while a custom script might offer more flexibility.
2.	Extraction via Form Recognizer: The FastAPI service takes the PDF file (either directly from SharePoint or passed by reference) and calls the Form Recognizer invoice model. This can be done with the Azure SDK for Python or a REST call. For example, using DocumentAnalysisClient.begin_analyze_document("prebuilt-invoice", file) will analyze the invoice with the prebuilt model[7]. The result contains all recognized fields and line items. The output JSON includes fields like “Vendor Name”, “Invoice Id (number)”, “Invoice Date”, “Invoice Total”, tax amounts, line item descriptions, quantities, unit prices, etc., if present[2].
3.	Interpreting Results: Our service will parse the Form Recognizer results and transform them into a more convenient structure (e.g., a Python dict or ORM object representing the invoice). Any fields with low confidence could be marked for the user’s attention. If certain expected fields are missing or the model is not very confident, we ensure those will be clearly highlighted in the UI. In most cases, however, the pre-trained model’s accuracy will mean minimal corrections are needed – this has been demonstrated in practice where prebuilt models dramatically reduce data entry workload[8].
4.	Data Storage: The extracted data can be temporarily stored in an Azure database or in-memory cache awaiting user review. We might use an Azure SQL Database or Azure Cosmos DB to store the invoice records and their fields, along with the original PDF link. Storing results ensures we have an audit trail and can re-load the data for the UI even if the session closes. For Phase 1, a simple relational table for “Invoice_Staging” could suffice, capturing fields like invoice ID, vendor, date, amount, and a JSON of line items. This staging table will be the source for the UI and later for integration to GP.
1.2 Staging UI for Verification and Correction (Human-in-the-Loop)
After extraction, the invoice data and the image of the invoice need to be presented to a human user (AP clerk or manager) for verification. This is a crucial step to catch any OCR errors and to validate the information before it enters the financial system. The user interface will show the invoice document alongside the extracted fields in an editable form:
•	The React frontend will provide a screen where the left (or top) side displays the invoice PDF or an image rendering of it, and the right (or bottom) side displays a form/table of the extracted data. The user can scroll the invoice and cross-check that the fields were extracted correctly. If a field is incorrect (for example, a misread invoice number or an incorrect total), the user can correct it in the form.
•	The invoice line items (the data table) will be shown in a grid or table component. Each line (item description, quantity, price, total) extracted by the AI will populate a row. The user can edit these as needed (e.g., if OCR missed a line or got a number wrong). There could also be functionality to add a missing line item or remove an extra one, to handle edge cases where the AI output needs adjustment.
•	Highlighting & Confidence: If possible, we might highlight portions of the invoice image corresponding to a selected field (since Form Recognizer provides bounding box coordinates for each field). This would enhance the review experience – e.g., when the user focuses on the “Total Amount” field in the form, the UI could highlight where that amount is on the invoice image. Such features have been used in invoice processing solutions to streamline validation[9]. We can retrieve word coordinates from the Form Recognizer result and use a PDF viewer library or canvas overlay in React to implement this.
•	User Actions: After verifying and making any corrections, the user will indicate approval to proceed (this is essentially a Section 34 verification step if the user is the responsible manager, or a pre-approval by an AP clerk – see Phase 2/3 for more on roles). The UI will have an “Approve/Submit” button to confirm the data is correct. There may also be a “Reject” or “Re-process” option if the invoice is unreadable or not authorized, but in Phase 1 we mainly focus on capturing correct data.
•	Once submitted, the corrected data is saved back to the database (updating the staging record). At this point, the data is ready for the next phase. We will also keep an audit log of what changes were made by the user (for accountability and future model improvement, if needed).
This human validation step is critical for quality control. Even with 95% accuracy from AI, a human check ensures near 100% accuracy and catches any unusual cases. The inclusion of a user validation stage aligns with best practices for content processing workflows: as Microsoft’s reference architecture notes, systems should include automatic quality checks and user validation for business documents like invoices[10]. The workflow will allow the user to “review the structured output, correct any inaccuracies, and save the final validated results”[9]. This gives the organization confidence in the data before it feeds into financial approvals or payments.
1.3 Tools & Technologies for Phase 1
•	Azure Form Recognizer (Document Intelligence) – for AI-based OCR and key field extraction. We will use the prebuilt invoice model via Python SDK or REST API. This avoids the need to train our own model and leverages a proven service that “extracts key fields and line items from invoices... and returns a structured JSON data representation”[11].
•	Python FastAPI service – to orchestrate the OCR call and handle data between front-end and back-end. FastAPI will expose endpoints such as POST /invoices/{id}/extract (to trigger OCR on a given invoice file) and GET /invoices/{id} (to fetch extracted data for the UI), etc. It will also handle the POST /invoices/{id}/approve when the user submits the verified data, updating the database and moving the workflow to the next stage.
•	React frontend – for the user interface. This will likely be a single-page application allowing users to select an invoice (or be prompted when a new one is ready for review), view the document, and edit/approve the data. We may use a library like PDF.js to render PDFs in the browser, and standard form libraries or custom tables for the data.
•	Data storage – an Azure SQL Database or Azure Cosmos DB for storing invoice data and tracking statuses (e.g., “pending review”, “approved”). A relational DB might work well since invoice header and line items can be modeled in tables (Invoices, InvoiceLines). Cosmos DB is another option if we prefer schema-flexible JSON storage (the Form Recognizer JSON could be stored directly). The choice may depend on the existing Azure environment and preferences for integration with GP (SQL might make it easier to interface with GP’s tools).
•	Integration triggers – optional use of Power Automate or Azure Functions for integration. For instance, a Power Automate flow could monitor the SharePoint library and call an HTTP webhook (our FastAPI) when a new file arrives. This can kick off Phase 1 automatically whenever an invoice is uploaded by a vendor or scanning process. Alternatively, we implement a polling or a manual upload in the UI. Using Power Automate here can simplify connecting SPO to Azure without writing a lot of boilerplate code, since Power Automate can leverage connectors and AI Builder models to extract invoice data and push it into systems like GP (as demonstrated by third-party solutions[12][13]). However, because we have a custom AI extraction pipeline, we might only use Power Automate for notifications or minor glue, keeping the core extraction in our control.
•	Security – We will ensure the solution respects security and privacy. PDFs might contain sensitive supplier information, so data in transit between SharePoint, our service, and Azure AI will be encrypted. We’ll also restrict access to the UI to authorized users (with government network or AD authentication). Azure Form Recognizer can be used with a secure endpoint and keys, and all data can be kept within Azure data centers in compliance with government IT policies (e.g., using Azure region in Canada if required).
By the end of Phase 1, we will have a functioning system where invoices are uploaded and quickly turned into structured data, which the AP team can validate through an intuitive interface. This delivers immediate benefits: time savings (processing an invoice with AI takes seconds vs. manual data entry taking minutes or more), reduced errors, and the foundation for further automation. It also sets up the database of invoice records that will be used in Phase 2 and 3.
Phase 2: Purchase Order Matching and Section 34 Compliance
Objective: Enhance the system to automatically match invoices with their corresponding Purchase Orders (POs) and confirm that the invoice details align with what was ordered and received. This phase ensures compliance with Section 34 of the Financial Administration Act, which requires verification that goods/services have been received and the invoice is correct before payment[1]. In practical terms, Section 34 means someone with delegated authority must certify that the invoice is valid (the work was performed or goods supplied per the contract) before it can be approved for payment. Our system will assist in this by cross-referencing invoice data against the purchase order and flagging any discrepancies.
2.1 Section 34 Requirements and Context
In the federal government context, Section 34 verification is a mandatory control step. The manager or official with Section 34 signing authority must confirm: (a) the goods or services billed were indeed received/rendered satisfactorily, (b) the invoice matches the terms of the PO or contract (correct rates, quantities, etc.), and (c) the invoice amount is within the authorized limits. Only after this certification can a financial officer with Section 33 authority release the payment[14].
In practice, departments often implement this by having the invoice data compared to procurement records. As noted in an audit, “the clerk or administrator entering the invoice into the system will ensure that Section 34 verification has been signed, that the invoice does not exceed any of the monetary limits and that goods and services were received.”[15]. Our system will mirror this practice in an automated way: it will check the invoice against the PO to ensure consistency and limits, and record the Section 34 approval (digitally).
2.2 Implementation of PO-Invoice Matching
To implement PO matching, we need access to the purchase order data corresponding to each invoice. There are a few scenarios: the invoice might contain a PO number reference (which is common – vendors often quote a PO number on the invoice), or we may deduce it by vendor and contract. For simplicity, we assume the invoice has a PO number field (our OCR in Phase 1 will likely pick it up if present). With that, the system will:
•	Retrieve PO Details: Using the PO number, query the database or system that holds the PO. If Dynamics GP is being used for procurement, GP itself might store POs and receiving information. Dynamics GP can be accessed via integration tools like eConnect or OData if available, or we could have a replica of relevant PO data in our Azure database. (If direct GP integration is complex for Phase 2, we could also do a one-time or periodic export of open POs from GP into a reference table in Azure to query against.) We’ll retrieve details such as the vendor, PO line items (descriptions, ordered quantities, unit prices), and the remaining balance or received quantity on that PO.
•	Match Line Items: The system will compare the invoice’s line items (from Phase 1 extraction) with the PO line items:
•	Check that each item on the invoice can be mapped to an item or line on the PO. This might be by an item code or description match. If exact matching is tricky (e.g., descriptions differ slightly), the user interface can allow manual linking. But we can often use fuzzy matching on description or a reference number. If the invoice references the PO line or item code, that simplifies it.
•	Check quantities and prices: For each matched line, ensure the invoice quantity does not exceed the PO’s ordered quantity (or remaining receivable). The price per unit on the invoice should match the PO (or be within an allowable variance if taxes or minor differences exist).
•	Calculate totals and ensure the invoice total amount is not greater than the PO’s total (or remaining balance). Any over-billing or unexpected charge would be flagged.
•	If the PO covers multiple deliveries, we might allow partial matching (e.g., if the PO was for 100 units and this invoice is for 50, we would note that 50 remain on the PO). The system might update a “remaining quantity/amount” field on the PO reference if we were tracking partially billed POs.
•	Check Receipt of Goods/Services: Ideally, Section 34 also means verifying that goods were received in good order or services were performed. In many systems, this is done by a receiving report or service acceptance form. If such data is tracked (say, someone enters a Goods Receipt in GP for the PO), we could incorporate that: ensure there is a corresponding receipt for the items invoiced. If not, it’s a signal that maybe the goods weren’t officially recorded as received yet. For now, if we assume the manager reviewing the invoice is the one who can attest to receipt, we at least ensure that person checks a box saying "Yes, goods/services received." The system can include a field for the Section 34 approver to confirm this.
•	UI for Matching: The React UI will extend to show PO information side-by-side with invoice info during the verification step. For instance, when an invoice is loaded, the system fetches the PO lines and displays them next to the invoice lines, possibly highlighting any discrepancies (quantity or price mismatches in red). The user (who might now be a manager performing Section 34) can see exactly if the invoice matches the PO. If something is off (e.g., the invoice has an item that wasn’t on the PO), the system flags it and the user would then have to decide (e.g., reject the invoice for correction, or resolve it outside the system).
The outcome of Phase 2 is that for each invoice, the system can record a “Section 34 verification complete” status when all checks pass and the responsible manager approves. Essentially, the manager’s digital approval in our system will certify that “the goods were received or services rendered as contracted” and that the invoice is correct[14]. We will capture the name, date, and perhaps electronic signature or login of the Section 34 delegate who performs this approval, as this is important for audit purposes (similar to how a physical signature would be captured otherwise).
By automating the PO match, we enforce controls: any invoice that exceeds authorized amounts or doesn’t match a PO cannot proceed without manual intervention. This helps prevent errors or improper payments. It aligns with Section 34 compliance in that each payment is verified against the terms and conditions initially agreed to with the supplier (quantity, price, etc.)[16][17]. If our system finds an issue, it essentially replicates what a diligent manager would do – hold the invoice and seek clarification or correction before approval.
2.3 Technology Considerations in Phase 2
•	Data integration with GP: We need PO data, which likely resides in Dynamics GP (or potentially another procurement system). Assuming GP, we may use an integration service or API. Dynamics GP is an older platform but supports data integration via tools like Integration Manager or eConnect[18]. We could set up a scheduled job or API call to fetch POs from GP into our Azure DB. If using eConnect, our Python service could call a stored procedure or web service to retrieve PO info by number. Another approach is to use a third-party connector or to export GP data periodically. This detail can be worked out with the GP support team – the key is we need read access to POs and possibly write access to create invoices (Phase 3).
•	Business rules: Implement logic for matching and tolerance. For example, allow a small variance in price or total (if policy permits, e.g., due to currency rounding) or flag any difference strictly. Also, ensure one invoice is not paid twice (we might check if an invoice number from the same vendor already exists in the system or GP, to avoid duplicates).
•	User roles: In Phase 1, an AP clerk might do the initial data review. In Phase 2, a manager or technical authority might do the PO match approval (Section 34). We should incorporate a notion of user roles and permissions in the app – e.g., clerk prepares the invoice data, but only a manager (with Sec.34 delegation) can give the final OK at this stage. The system might route the invoice to that manager’s queue for approval after the clerk’s initial verification. This sets the stage for the approval workflow in Phase 3.
•	Audit trail: We will log the results of the matching (e.g., “matched to PO #1234, all good” or specifics like “line 2: 10 units at $5 each, OK”). If any override is needed (say a manager decides to approve despite a minor discrepancy), the system should record that decision explicitly (with rationale if possible). Maintaining these logs is important for audits and for the Section 33 officer later to trust that Section 34 was properly executed[19].
By the end of Phase 2, the process will not only capture invoice data but also ensure each invoice is validated against procurement records and policy before moving forward. This fulfills the Section 34 control digitally: the system helps the responsible person certify the invoice, with evidence. It reduces the risk of paying incorrect or fraudulent invoices since everything is checked against what was authorized. It also means by the time an invoice goes to final approval, it’s essentially ready to pay, having passed all front-end checks.
Phase 3: “Red Box” Approval Workflow
Objective: Implement the final approval routing (the so-called “Red Box” process) for invoices that have passed Section 34 verification. In government finance offices, the “red folder” or “red box” often refers to the package of documents sent for executive approval – here it symbolizes the final sign-offs needed (including Section 33 authorization). In this phase, the system will route the verified invoice to the appropriate approvers and then integrate the approved invoice data into Dynamics GP for payment processing. This phase completes the automation by replacing any remaining email/paper approval circulation with a digital workflow.
3.1 Approval Workflow and Section 33 Authorization
After Section 34 approval in Phase 2, an invoice typically requires a Section 33 approval. Section 33 of the FAA is the financial officer’s sign-off that all is in order and funds can be released[14]. In practice, Section 33 is usually a centralized finance function – the officer ensures that a Section 34 signature is present and valid, and then they approve the payment. Often, the Section 33 officer might not re-check every detail of the invoice due to volume, instead relying on the Section 34 verification system in place[20][19]. Our system, having enforced Section 34 checks, will give the Section 33 approver confidence to approve more quickly.
The workflow in our solution will look like this: - Once an invoice is marked “Section 34 approved” (Phase 2 complete), the system moves it into a queue for financial approval (Section 33). - Notify the Section 33 officer or group. This could be done via email or a dashboard. If using Power Automate, we can leverage the Approvals feature: for example, automatically send a notification with invoice details to the finance officer’s email or Microsoft Teams, where they can click approve/reject. This would be a low-code way to implement final approvals. Alternatively, in the custom React app, we can have an "Approvals" page where users with Section 33 role can see all invoices awaiting their sign-off.
- The approver can review summary info of the invoice (and possibly drill into the details if needed, including viewing the original invoice image and the PO match info). Because everything was presumably checked, this might just be a cursory review. They then click “Approve Payment” (or “Reject” if something seems off). Approving at this stage signifies Section 33 authorization – our system will log that this user approved on this date/time. If rejected, the invoice could be sent back for further investigation (or marked to be corrected/resubmitted).
- For certain invoices (especially large dollar values or sensitive expenditures), there might be additional higher-level approvals (for example, a Director or CFO might need to sign off beyond a threshold). The “Red Box” could imply such high-level approval. The workflow should be flexible to accommodate multi-tier approvals. We can design approval rules: e.g., invoices over $100k require CFO approval in addition to the regular Section 33. If so, the system routes to the CFO after the finance officer, etc. This can be configured as needed once the exact process flow is confirmed. The use of a workflow engine (like Power Automate or a Python workflow library) can handle sequential or parallel approvals with conditions.
- Tracking and Reminders: The system will track who has approved and who is pending. We can implement reminders for approvers if an invoice sits too long (to avoid delays). Also, everyone involved can see the status (e.g., “Awaiting Section 33 approval by [Name]”). This transparency helps manage the process.
3.2 Integration to Dynamics GP (Payment System)
Once all required approvals are complete (Section 34 and Section 33 done, and any “red box” executive approvals done), the invoice is ready to be ingested into Dynamics GP for payment processing. At this final step, the system should transfer the data to GP so that a transaction (vendor invoice in AP module) is created, as if the AP staff had entered it manually. Options to achieve this include:
•	Direct import via GP’s APIs: Use Dynamics GP’s eConnect or Integration Manager to create a Payables Transaction (vendor invoice) in GP. For example, we can have our system compile the invoice header and line data into the format GP expects (perhaps an XML or a call to a stored procedure) to insert the invoice. GP will then treat it like any other invoice: it can be posted and a payment issued through the usual GP check/EFT run. This approach might need some development on the GP side (setting up an integration endpoint). Many third-party AP automation tools do this – e.g., Mekorma’s Invoice Capture uses Power Automate and then “transfers invoice data into the ERP system [GP]”, creating the transactions automatically[21][12]. We aim to do similarly, just with our custom pipeline.
•	Staging table approach: Alternatively, we could write the approved invoice data to a SQL staging table that GP’s Integration Manager can pull from. The finance team could then run the integration (or it could run automatically on a schedule). This is slightly less direct but might require fewer customizations if the organization already uses Integration Manager for other imports.
•	Attachment of invoice image: A nice feature would be to attach the invoice PDF to the GP transaction for record-keeping. If GP supports attachments (it does via Document Attach), we could potentially link the PDF from SharePoint into GP, so that later anyone auditing or viewing that transaction in GP can open the original invoice. Mekorma’s solution mentions having supporting documents attached in GP[22] – we could strive for that as well by using GP’s document attachment capabilities or providing a link. If not in Phase 3, this could be a later enhancement.
Final Approval Logging: When the invoice is transferred to GP, it essentially means payment is authorized. Our system will mark the invoice record as “Completed” or “Transferred to GP” with the date. Section 33 officer’s approval is logged as the final gate. This digital record can serve in place of a physical signature sheet – it proves that “an individual with delegated financial signing authority certified under Section 34” and a Section 33 officer released the payment[1]. All of this should be reportable if needed (e.g., we could generate a report of all invoices processed, with who approved under Sec34 and Sec33, to satisfy auditors that the controls are working).
3.3 Additional Workflow Implementation Notes
•	We will implement notifications at key steps. For example, when an invoice is ready for Section 34 approval, notify the responsible manager (perhaps via email or a Teams message with a link to the app). When it’s ready for Section 33, notify the finance officer. This ensures approvers are aware they have a task. If using Power Automate, it can handle sending actionable messages to users; if fully custom, we might integrate an email service or rely on users checking the app dashboard.
•	Mobile/Remote Approval: It might be useful if approvers can approve on the go (some managers may not always be at their desks). If using Power Automate Approvals or a web app, either way, as long as it’s mobile-friendly or accessible through their devices, it can expedite the process. (This is an area where using the Power Platform shines – e.g., Mekorma’s PowerApprovals allows mobile approval of payments for GP[23]. We can consider similar convenience if it adds value.)
•	“Red Box” terminology: While not a technical term, it historically refers to a folder of documents sent up the chain for sign-off. Our digital equivalent ensures that once an invoice is fully verified, all the approver has to do is click approve in a centralized system – no physical folder. This speeds up the cycle. Government workflow automation studies have noted that digitizing these executive approval processes “eliminates bottlenecks and speeds up decisions”, as well as provides better tracking[24][25]. We should emphasize the improved turnaround: no more chasing signatures on paper; the system will track and remind automatically, which is especially crucial for meeting prompt payment timelines.
By the end of Phase 3, the invoice processing pipeline is fully implemented: from invoice ingestion to data extraction, verification (Section 34), approval (Section 33/Red Box), and insertion into the financial system for payment. All steps are digital, with appropriate oversight built in.
Future Considerations and Extensibility
While the above phases establish a robust solution, there are additional considerations and potential enhancements to keep in mind:
•	Bilingual Invoice Support: Since eventually both official languages (English & French) must be handled, we will test the OCR on French invoices. Azure’s invoice model supporting French means the same extraction process should work on French documents[5]. We may need to adjust field label detection (e.g., "Invoice Number" vs "Numéro de facture") – but the prebuilt model is trained on many languages, so it likely handles French labels out-of-the-box. We should verify this. The UI should also be able to display French text (ensure UTF-8 handling for accents). If needed, we can make the app interface bilingual (labels, buttons in UI switching between English/French) to comply with government bilingualism requirements for internal systems. This could be Phase 4 in future.
•	Learning from Corrections: Over time, we can improve the AI extraction by learning from any manual corrections. If we see a pattern of fields the AI struggles with (perhaps a certain vendor’s invoice format), we could consider training a custom model in Form Recognizer for that format, or adjusting our parsing logic. Form Recognizer allows custom training using labeled samples, which could further boost accuracy if needed[26][27]. However, given the high base accuracy, this might be low priority unless specific cases demand it.
•	Scaling and Performance: As volume grows, we should ensure the architecture scales. Azure Form Recognizer is a cloud service that can handle high volumes (cost is per page, and Azure can auto-scale to thousands of pages easily[28]). Our FastAPI service can be containerized and scaled out if needed (or we could move to serverless Azure Functions for extraction to handle spikes seamlessly). The database should be sized appropriately. We should also implement retry logic and error handling (e.g., if the OCR service fails for a document, catch it and allow reattempt, etc.).
•	Compliance and Security: Being in a government context, we should ensure the solution complies with IT security policies (encryption, data residency, access controls). We will likely conduct privacy assessment if invoices contain personal info, and ensure vendor data is protected. Also, since this automates financial approvals, we should build in controls like segregation of duties (the same person shouldn’t do Section 34 and Section 33 on the same transaction, for example – our workflow can enforce that by role). Audit logs should be immutable or at least protected.
•	Integration with Existing Tools: The solution should not exist in a vacuum. If the department uses an existing document management or workflow tool, we may integrate. For instance, SharePoint could be used not just for storing PDFs but also for tracking status (we could update metadata or move the file to a “Approved” library once done). Dynamics GP might have some workflow capability we can leverage as backup. The approach we take (custom vs Power Platform) can be adjusted if the client later prefers a more off-the-shelf path. Notably, there are products like Quadient/AP automation that integrate with GP[29], but our solution is tailored to the specific environment and can be more flexible.
Conclusion: By proceeding through phases, we can deliver immediate value in Phase 1 (automating data entry with AI and providing a faster, error-reduced process) and then progressively layer on the critical financial controls in Phase 2 and 3. The end result will be a streamlined AP process where invoices are processed in a fraction of the time, with strong integrity: every invoice is checked against what was ordered (ensuring Section 34 compliance) and approved by the right people before payment. This reduces late payments and errors, and increases transparency. Invoices will “show up in Dynamics GP” with minimal manual effort[22][13], and approvers will have oversight through an integrated validation process. By using technologies like Azure Form Recognizer and a modern web interface, we combine AI efficiency with human judgment where needed, achieving a balanced and controlled AP automation.
Overall, this phased approach positions the organization to modernize its invoice processing in line with best practices and statutory requirements, while leveraging the team’s Python/React skills and existing Microsoft infrastructure.
Sources:
•	Government of Canada Financial Administration Act – Sections 32, 33, 34 (expenditure controls)[1]
•	PPSC Audit on Account Verification (highlights roles of Sec.34 and Sec.33 in invoice approval)[15][19]
•	Azure Form Recognizer documentation – prebuilt invoice model capabilities (key fields extraction, multi-language support)[11][2]
•	Emiral Group Tech Blog – Extracting invoice data with Azure Form Recognizer and Python (confirms fields captured and JSON output)[2][3]
•	Pavan Trivedi (Medium, Oct 2025) – Building an Intelligent Invoice Processing System with Azure AI (notes 95%+ accuracy of prebuilt invoice model)[4]
•	Mekorma Invoice Capture for Dynamics GP (ERP Software Blog, 2022) – describes using Power Automate + AI Builder to extract invoices and create transactions in GP[12][13]
•	SimpliGov article on accelerating government document workflows (on replacing “red folder” approval processes with digital workflows for faster approvals)[24][25]
________________________________________
[1] [14] [16] [17] PPSC - Audit of the Account Verification Framework
https://www.ppsc-sppc.gc.ca/eng/pub/aavf-vcvc/2010/index.html
[2] [3] [6] [7] [28] Extracting invoice data with Azure Form Recognizer and Python | Emiral
https://emiralfg.com/en/blog-2/extracting-invoice-data-with-azure-form-recognizer-and-python/
[4] [8] Building an Intelligent Invoice Processing System with Azure AI | by Pavantrivedi | Oct, 2025 | Medium
https://medium.com/@pavantrivedi2001/building-an-intelligent-invoice-processing-system-with-azure-ai-5ad3827dc09f
[5] [11] Invoice data extraction – Document Intelligence - Foundry Tools | Microsoft Learn
https://learn.microsoft.com/en-us/azure/ai-services/document-intelligence/prebuilt/invoice?view=doc-intel-4.0.0
[9] [10] Extract and Map Information from Unstructured Content - Azure Architecture Center | Microsoft Learn
https://learn.microsoft.com/en-us/azure/architecture/ai-ml/idea/multi-modal-content-processing
[12] [13] [21] [22] [23] Invoice Automation for Microsoft Dynamics GP - ERP Software Blog
https://erpsoftwareblog.com/2022/04/invoice-automation-for-microsoft-dynamics-gp/
[15] [19] [20] Checks and Balances
https://www.acfo-acaf.com/wp-content/uploads/2015/07/cb-vol2-en.pdf
[18] Importing Accounts Receivable Invoice Information into GP
https://community.dynamics.com/forums/thread/details/?threadid=37ac97dd-bb20-4714-8c4b-45ed475259b7
[24] [25] Accelerating Executive Document Review & Tracking| SimpliGov
https://simpligov.com/revving-up-red-folders-accelerating-the-executive-document-review-and-tracking-process/
[26] [27] Intelligent Document Processing with Azure Forms Recognizer
https://www.analyticsvidhya.com/blog/2023/03/intelligent-document-processing-with-azure-form-recognizer/
[29] Microsoft Dynamics GP AP Automation & Invoice Processing
https://www.quadient.com/en/ap-automation/integrations/microsoft-dynamics
